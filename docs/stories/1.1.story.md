# Story 1.1: Offline LINE Chat History Viewer MVP

## Status
- Approved

## Story
**As a** user,
**I want** to upload a LINE chat history text file and search its content offline,
**so that** I can easily find past conversations and memories without compromising my privacy.

## Acceptance Criteria
1.  **文件上傳與解析**
    *   使用者可以透過網頁介面選擇一個 .txt 格式的 LINE 聊天記錄備份檔。
    *   應用程式必須在瀏覽器本地解析該檔案的內容，不會將檔案上傳至任何伺服器。
    *   解析過程中，網頁應提供適當的載入或進度指示。
    *   解析完成後，所有聊天訊息應立即顯示在主要介面上。

2.  **核心搜尋功能**
    *   主要介面頂部應有一個顯眼的搜尋框。
    *   使用者在搜尋框輸入關鍵字後，系統應立即顯示所有**包含**該關鍵字的訊息列表（即「包含關鍵字即可」的模糊搜尋）。
    *   搜尋與顯示結果的效能應足夠流暢，即使面對 50MB 大小的聊天記錄檔（針對進階使用者）也能保持響應。

3.  **搜尋結果互動與上下文顯示**
    *   搜尋結果列表中的每一則訊息都應該可以被點擊。
    *   點擊搜尋結果後，網頁應跳轉至完整對話中的該則訊息位置。
    *   跳轉後，應顯示該則訊息及前後各 100 則訊息的上下文（共 201 則）。

4.  **發言人篩選**
    *   應提供篩選器讓使用者可以從列表中選擇一個或多個發言人。
    *   篩選器應列出聊天記錄中所有獨特的發言人。
    *   篩選條件應與關鍵字搜尋結果共同作用。

5.  **日期範圍篩選**
    *   應提供篩選器讓使用者可以選擇特定日期或日期範圍。
    *   篩選條件應與關鍵字搜尋結果及發言人篩選共同作用。

6.  **使用者介面與體驗**
    *   初次載入頁面應簡潔，包含清晰的產品標題、強調離線和安全的說明，以及一個大型的「選擇檔案」按鈕。
    *   整體介面設計應直觀易用，特別是對於佔 70% 的一般使用者。

7.  **非功能性需求**
    *   **離線操作**：所有功能必須完全在使用者本地瀏覽器執行，無需網路連線。
    *   **隱私保護**：所有聊天記錄資料絕不離開使用者的裝置。
    *   **效能**：即使處理 50MB 的純文字 LINE 聊天備份檔，解析和搜尋過程也應快速且流暢，避免瀏覽器卡頓或崩潰。
    *   **跨平台**：作為網頁應用，應能在手機、電腦的主流瀏覽器（Chrome, Firefox, Safari, Edge）中正常運作。

## Tasks / Subtasks
- [ ] **Task 1: Project Setup (AC: 7)**
  - [ ] Initialize a new frontend project (e.g., using Vite + React/Vue).
  - [ ] Setup basic project structure, linting, and formatting tools.
- [ ] **Task 2: Landing Page UI (AC: 6)**
  - [ ] Create the main landing page component.
  - [ ] Implement the title, subtitle, and the large "Select File" button.
  - [ ] Style the page to be clean and focused.
- [ ] **Task 3: File Handling and Parsing (AC: 1, 7)**
  - [ ] Implement the file input logic to accept `.txt` files.
  - [ ] Create a robust parser module for the LINE chat file format.
  - [ ] Implement loading/progress indicators during parsing.
  - [ ] Ensure the parser can handle files up to 50MB without crashing the browser.
- [ ] **Task 4: Main View and Message Display (AC: 1)**
  - [ ] Create the component to display the list of all parsed messages.
  - [ ] Implement efficient rendering for potentially long message lists (virtualization).
- [ ] **Task 5: Search and Filter Implementation (AC: 2, 4, 5)**
  - [ ] Create the main keyword search input component.
  - [ ] Create the advanced filter components (speaker list, date range picker).
  - [ ] Implement the client-side search logic (substring matching).
  - [ ] Implement the filtering logic for speakers and dates.
  - [ ] Ensure search and filter logic works together and is performant.
- [ ] **Task 6: "Jump to Context" Feature (AC: 3)**
  - [ ] Implement the click handler on search results.
  - [ ] Create the logic to display the message in the main view, scrolled into position.
  - [ ] Implement the logic to efficiently fetch and display the 100 messages before and after the selected message.
- [ ] **Task 7: Testing (AC: 7)**
  - [ ] Write unit tests for the LINE chat parser module.
  - [ ] Write unit tests for the search and filter logic.
  - [ ] Write integration tests for the main user workflow (upload -> search -> jump).

## Dev Notes
- **Previous Story Insights**: Not applicable. This is the first story.
- **Data Models**: No specific guidance found in architecture docs. The primary data model will be the parsed message object (e.g., `{ timestamp: Date, author: string, content: string }`).
- **API Specifications**: No specific guidance found in architecture docs. This is a fully offline, client-side application with no APIs.
- **Component Specifications**: No specific guidance found in architecture docs.
- **File Locations**: No specific guidance found in architecture docs. A standard frontend project structure (e.g., `src/components`, `src/utils`, `src/views`) should be established.
- **Testing Requirements**: No specific guidance found in architecture docs. Based on the tasks, unit tests for logic (parsing, searching) and integration tests for the UI flow are required.
- **Technical Constraints**: The application must be a pure client-side web application, runnable in all modern browsers. It must handle large files efficiently without relying on a backend.

### Testing
- **Test file location**: No specific guidance found in architecture docs. Standard conventions (e.g., `*.test.js` or `*.spec.js` colocated with source files) should be used.
- **Test standards**: No specific guidance found in architecture docs.
- **Testing frameworks and patterns to use**: No specific guidance found in architecture docs. Standard frameworks like Jest/Vitest and React Testing Library are recommended.

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2026-01-03 | 1.0 | Initial draft creation | BMad Agent (Bob) |

## Dev Agent Record
### Agent Model Used
*(To be filled by Dev Agent)*

### Debug Log References
*(To be filled by Dev Agent)*

### Completion Notes List
*(To be filled by Dev Agent)*

### File List
*(To be filled by Dev Agent)*

## QA Results
*(To be filled by QA Agent)*
